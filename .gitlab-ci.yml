# Using the official Python Docker image as default
image: "python"

before_script:
  - python --version
  - uname -a
  - apt-get update
  - apt-get install -y libldap2-dev libsasl2-dev
  - "[ -r requirements.txt ] && pip install -r requirements.txt"
  - pip install tox

stages:
  - Test

unit_test:
  stage: Test
  script:
    - tox

pages:
  stage: test
  dependencies:
    - unit_test
  script:
    - mv coverage public/
  artifacts:
    paths:
      - public/coverage
    expire_in: 30 days
  only:
    - master

